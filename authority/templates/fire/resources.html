{% extends "base.html" %}
{% block content %}

<style>
/* Background */
.resource-bg {
    background: linear-gradient(135deg, #811978, #81347d, #9b4e9f);
    padding: 35px;
    border-radius: 12px;
    color: white;
}

/* Glass table box */
.glass-box {
    background: rgba(255, 255, 255, 0.18);
    backdrop-filter: blur(10px);
    border-radius: 15px;
    padding: 20px;
    box-shadow: 0px 4px 25px rgba(0,0,0,0.35);
}

/* Header */
.table-header {
    background: #a30000 !important;
    color: white;
}

/* Row hover */
tbody tr:hover {
    background: rgba(255,255,255,0.15) !important;
}

/* Filter Box */
.filter-box {
    background: rgba(255,255,255,0.18);
    padding: 15px;
    border-radius: 12px;
    margin-bottom: 20px;
}

/* Status colors */
.status-green { color: #00e676; font-weight: 600; }
.status-orange { color: #ff9800; font-weight: 600; }
.status-red { color: #ff5252; font-weight: 600; }
</style>


<div class="container resource-bg mt-4">

    <h2 class="text-center mb-4 fw-bold" style="text-shadow: 0 0 12px rgba(0,0,0,0.5);">
        ðŸš’ Fire Department Resources
    </h2>

    <!-- Filters -->
    <div class="filter-box">
        <div class="row">
            <div class="col-md-6 mb-2">
                <input id="resourceSearch" class="form-control" placeholder="Search by name or station...">
            </div>

            <div class="col-md-3 mb-2">
                <select id="statusFilter" class="form-select">
                    <option value="">Filter by Status</option>
                    <option value="Available">Available</option>
                    <option value="On Duty">On Duty</option>
                    <option value="Under Maintenance">Under Maintenance</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Resource Table -->
    <div class="glass-box table-responsive">
        <table class="table table-hover text-white" id="resourceTable">
            <thead class="table-header">
                <tr>
                    <th onclick="sortTable(0)">Resource Name</th>
                    <th onclick="sortTable(1)">Status</th>
                    <th onclick="sortTable(2)">Station</th>
                </tr>
            </thead>

            <tbody>
                <tr>
                    <td>Fire Engine 21</td>
                    <td><span class="status-green">Available</span></td>
                    <td>Station 1</td>
                </tr>
                <tr>
                    <td>Rescue Unit 14</td>
                    <td><span class="status-orange">On Duty</span></td>
                    <td>Station 2</td>
                </tr>
                <tr>
                    <td>Water Tender 7</td>
                    <td><span class="status-red">Under Maintenance</span></td>
                    <td>Station 3</td>
                </tr>
                <tr>
                    <td>Ladder Truck 9</td>
                    <td><span class="status-green">Available</span></td>
                    <td>Station 2</td>
                </tr>
            </tbody>
        </table>
    </div>

</div>


<script>
// SEARCH + FILTER
function filterResources() {
    let search = document.getElementById("resourceSearch").value.toLowerCase();
    let status = document.getElementById("statusFilter").value;
    let rows = document.querySelectorAll("#resourceTable tbody tr");

    rows.forEach(row => {
        let text = row.innerText.toLowerCase();
        let rowStatus = row.children[1].innerText;

        if (text.includes(search) && (status === "" || rowStatus.includes(status))) {
            row.style.display = "";
        } else {
            row.style.display = "none";
        }
    });
}

document.getElementById("resourceSearch").addEventListener("keyup", filterResources);
document.getElementById("statusFilter").addEventListener("change", filterResources);


// SORT TABLE
function sortTable(n) {
    let table = document.getElementById("resourceTable");
    let switching = true;
    let dir = "asc";

    while (switching) {
        switching = false;
        let rows = table.rows;

        for (let i = 1; i < rows.length - 1; i++) {
            let x = rows[i].getElementsByTagName("TD")[n].innerText.toLowerCase();
            let y = rows[i + 1].getElementsByTagName("TD")[n].innerText.toLowerCase();
            let shouldSwitch = false;

            if ((dir === "asc" && x > y) || (dir === "desc" && x < y)) {
                shouldSwitch = true;
                break;
            }
        }

        if (shouldSwitch) {
            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
            switching = true;
        } 
        else if (dir === "asc") {
            dir = "desc";
            switching = true;
        }
    }
}
</script>

{% endblock %}